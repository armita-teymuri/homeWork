<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="../jquery-3.6.1.min.js"></script>
    <title>Document</title>
  </head>
  <style>
    table {
      color: red;
    }
    td {
      width: 10px;
      border-radius: 100%;
    }
  </style>
  <body>
    <table></table>
    <script>
      t = $("table");
      A = [
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      ];
      //snake location
      c = [1, 1, 1, 1, 1];
      r = [1, 2, 3, 4, 5];
      x = 0;
      y = 1;
      bool = true;
      var randomRow = 0;
      var randomCol = 0;

      //create food for snake
      const getRandom = () => {
        randomRow = Math.floor(Math.random() * A[0].length);
        randomCol = Math.floor(Math.random() * A.length);
      };
      getRandom();
      const render = () => {
        t.empty();

        A.forEach((row, ri) => {
          tr = $("<tr></tr>");
          row.forEach((cell, ci) => {
            if (ri == randomRow && ci == randomCol) {
              tr.append(`<td pos = "r${ri}c${ci}">*</td>`);
            } else {
              tr.append(`<td pos = "r${ri}c${ci}">-</td>`);
            }
          });
          t.append(tr);
        });
        //create snake

        for (i in c) {
          $(`td[pos=r${r[i]}c${c[i]}]`).text("");
          $(`td[pos=r${r[i]}c${c[i]}]`).css("background-color", "yellow");
          $(`td[pos=r${r[0]}c${c[0]}]`).css("background-color", "green");
        }
      };

      render();
      const update = () => {
        //badane mar donbale kalasj bere
        for (i = r.length - 1; i > 0; i--) {
          r[i] = r[i - 1];
          c[i] = c[i - 1];
          if (r[i] == randomRow && c[i] == randomCol) {
            getRandom();
          }
        }
        c[0] += x;
        r[0] += y;
        if (c[0] > 9) c[0] = 0;
        if (c[0] < 0) c[0] = 9;
        if (r[0] > 9) r[0] = 0;
        if (r[0] < 0) r[0] = 9;
        if (c[0] == randomCol && r[0] == randomRow) {
          c.push(0);
          r.push(0);
          getRandom();

          update();
        }
      };
      setInterval(() => {
        update();
        render();
        console.log(`x:${x} - y:${y}`);
      }, 400);

      $(document).keyup((e) => {
        switch (e.key) {
          case "ArrowUp":
            x = 0;
            y = -1;
            break;
          case "ArrowDown":
            x = 0;
            y = +1;
            break;
          case "ArrowLeft":
            if (x != 1) {
              x = -1;
              y = 0;
            }

            break;
          case "ArrowRight":
            if (x != -1) {
              x = +1;
              y = 0;
            }

            break;
          default:
            break;
        }
      });
    </script>
  </body>
</html>
